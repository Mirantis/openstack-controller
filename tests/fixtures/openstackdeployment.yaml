apiVersion: lcm.mirantis.com/v1alpha1
kind: OpenStackDeployment
metadata:
  annotations: {}
  labels: {}
  name: osh-dev
  namespace: openstack
spec:
  common:
    charts:
      releases:
        namespace: openstack
        values:
          images:
            tags:
              bootstrap: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              cinder_api: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/cinder:stein-bionic-20190827193015
              cinder_backup: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/cinder:stein-bionic-20190827193015
              cinder_backup_storage_init: docker-prod-local.docker.mirantis.net/mcp/ceph-config-helper:nightly
              cinder_db_sync: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/cinder:stein-bionic-20190827193015
              cinder_scheduler: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/cinder:stein-bionic-20190827193015
              cinder_storage_init: docker-prod-local.docker.mirantis.net/mcp/ceph-config-helper:nightly
              cinder_volume: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/cinder:stein-bionic-20190827193015
              cinder_volume_usage_audit: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/cinder:stein-bionic-20190827193015
              create_resources: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              db_drop: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              db_init: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              dep_check: quay.io/stackanetes/kubernetes-entrypoint:v0.3.1
              designate_api: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/designate:stein-bionic-20190827193015
              designate_central: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/designate:stein-bionic-20190827193015
              designate_db_sync: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/designate:stein-bionic-20190827193015
              designate_mdns: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/designate:stein-bionic-20190827193015
              designate_producer: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/designate:stein-bionic-20190827193015
              designate_sink: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/designate:stein-bionic-20190827193015
              designate_worker: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/designate:stein-bionic-20190827193015
              glance_api: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/glance:stein-bionic-20190827193015
              glance_db_sync: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/glance:stein-bionic-20190827193015
              glance_registry: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/glance:stein-bionic-20190827193015
              glance_storage_init: docker-prod-local.docker.mirantis.net/mcp/ceph-config-helper:nightly
              heat_api: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              heat_cfn: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              heat_cloudwatch: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              heat_db_sync: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              heat_engine: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              heat_engine_cleaner: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              heat_purge_deleted: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              horizon: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/horizon:stein-bionic-20190827193015
              horizon_db_sync: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/horizon:stein-bionic-20190827193015
              image_repo_sync: docker.io/docker:17.07.0
              keystone_api: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/keystone:stein-bionic-20190827193015
              keystone_credential_cleanup: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              keystone_credential_rotate: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/keystone:stein-bionic-20190827193015
              keystone_credential_setup: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/keystone:stein-bionic-20190827193015
              keystone_db_sync: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/keystone:stein-bionic-20190827193015
              keystone_domain_manage: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/keystone:stein-bionic-20190827193015
              keystone_federations_create: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              keystone_fernet_rotate: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/keystone:stein-bionic-20190827193015
              keystone_fernet_setup: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/keystone:stein-bionic-20190827193015
              ks_endpoints: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              ks_service: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              ks_user: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              mariadb: docker-prod-local.docker.mirantis.net/mcp/mariadb:10.2.23-bionic-1557188198369
              mariadb_backup: docker.io/openstackhelm/mariadb:latest-ubuntu_xenial
              mariadb_scripted_test: docker-prod-local.docker.mirantis.net/mcp/mariadb:10.2.23-bionic-1557188198369
              neutron_db_sync: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/neutron:stein-bionic-20190827193015
              neutron_dhcp: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/neutron:stein-bionic-20190827193015
              neutron_l3: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/neutron:stein-bionic-20190827193015
              neutron_linuxbridge_agent: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/neutron:stein-bionic-20190827193015
              neutron_metadata: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/neutron:stein-bionic-20190827193015
              neutron_openvswitch_agent: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/neutron:stein-bionic-20190827193015
              neutron_server: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/neutron:stein-bionic-20190827193015
              nova_api: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/nova:stein-bionic-20190827193015
              nova_cell_setup: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/nova:stein-bionic-20190827193015
              nova_cell_setup_init: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/heat:stein-bionic-20190827193015
              nova_compute: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/nova:stein-bionic-20190827193015
              nova_compute_ironic: docker.io/kolla/ubuntu-source-nova-compute-ironic:ocata
              nova_compute_ssh: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/nova:stein-bionic-20190827193015
              nova_conductor: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/nova:stein-bionic-20190827193015
              nova_consoleauth: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/nova:stein-bionic-20190827193015
              nova_db_sync: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/nova:stein-bionic-20190827193015
              nova_novncproxy: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/nova:stein-bionic-20190827193015
              nova_novncproxy_assets: docker.io/kolla/ubuntu-source-nova-novncproxy:ocata
              nova_placement: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/nova:stein-bionic-20190827193015
              nova_scheduler: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/nova:stein-bionic-20190827193015
              nova_service_cleaner: docker-prod-local.docker.mirantis.net/mcp/ceph-config-helper:nightly
              octavia_api: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/octavia:stein-bionic-20190827193015
              octavia_db_sync: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/octavia:stein-bionic-20190827193015
              octavia_health_manager: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/octavia:stein-bionic-20190827193015
              octavia_hm_port: docker-prod-local.docker.mirantis.net/mcp/octavia-hm:nightly
              octavia_housekeeping: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/octavia:stein-bionic-20190827193015
              octavia_worker: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/octavia:stein-bionic-20190827193015
              prometheus_create_mysql_user: docker-prod-local.docker.mirantis.net/mcp/mariadb:10.2.23-bionic-1557188198369
              prometheus_mysql_exporter: docker.io/prom/mysqld-exporter:v0.10.0
              prometheus_mysql_exporter_helm_tests: docker.io/openstackhelm/heat:newton-ubuntu_xenial
              prometheus_rabbitmq_exporter: docker.io/kbudde/rabbitmq-exporter:v0.21.0
              prometheus_rabbitmq_exporter_helm_tests: docker.io/openstackhelm/heat:ocata-ubuntu_xenial
              rabbit_init: docker.io/rabbitmq:3.7-management
              rabbitmq: docker.io/rabbitmq:3.7.13
              rabbitmq_init: docker.io/openstackhelm/heat:ocata-ubuntu_xenial
              rabbitmq_scripted_test: docker.io/rabbitmq:3.7.13-management
              tempest_run_tests: docker-dev-virtual.docker.mirantis.net/mirantis/oscore/oh/tempest:stein-bionic-20190827193015
        version: 0.1.0
      repositories:
      - name: osh
        url: https://harbor.mcp.mirantis.net/chartrepo/mcp-openstack-helm-20190828110147
      - name: osh-infra
        url: https://harbor.mcp.mirantis.net/chartrepo/mcp-openstack-helm-infra-20190827075122
    infra:
      repo: osh-infra
    openstack:
      repo: osh
      values:
        pod:
          replicas:
            api: 3
  domain_name: kaas-kubernetes-3af5ae538cf411e9a6c7fa163e5a4837
  features:
    cinder:
      backup:
        backend: ceph
      volume:
        backend: ceph
    database:
      local_volumes:
        enabled: true
    glance:
      backend: ceph
    keystone:
      users:
        admin:
          password: workshop
          username: admin
    messaging:
      create_user_credentials: true
      dedicated_rabbitmq:
        enabled: true
    neutron:
      backend: ovs
      external_networks:
      - bridge: br-ex
        interface: veth-phy
        mtu: null
        network_types:
        - flat
        physnet: external
        vlan_ranges: null
    nova:
      images:
        backend: local
    services:
    - block-storage
    - compute
    - identity
    - dashboard
    - image
    - ingress
    - mariadb
    - memcached
    - networking
    - orchestration
    - rabbitmq
    - load-balancer
    ssl:
      public_endpoints:
        enabled: false
  openstack_version: stein
  profile: base
  services:
    compute:
      nova:
        values:
          bootstrap:
            structured:
              flavors:
                options:
                  m1.extra_tiny_test:
                    disk: 1
                    id: 00000000-0000-0000-0000-000000000000
                    name: m1.extra_tiny_test
                    ram: 256
                    vcpus: 1
                  m1_tiny_test:
                    disk: 1
                    id: 00000000-0000-0000-0000-000000000001
                    name: m1.tiny_test
                    ram: 512
                    vcpus: 1
    identity:
      keystone:
        values:
          conf:
            keystone:
              DEFAULT:
                mykey: myvalue
    image:
      glance:
        values:
          bootstrap:
            enabled: true
            ks_user: admin
            structured:
              images:
                cirros:
                  container_format: bare
                  id: 00000000-0000-0000-0000-000000000000
                  image_file: cirros-0.4.0-x86_64-disk.img
                  image_type: qcow2
                  min_disk: 1
                  name: Cirros-4.0
                  private: false
                  properties:
                    os_distro: cirros
                  source_url: https://artifactory.mcp.mirantis.net/artifactory/test-images/
                fedora:
                  container_format: bare
                  id: 00000000-0000-0000-0000-000000000001
                  image_file: Fedora-Cloud-Base-27-1.6.x86_64.qcow2
                  image_type: qcow2
                  min_disk: 1
                  name: Fedora-27-1.6
                  private: false
                  properties:
                    os_distro: fedora
                  source_url: https://artifactory.mcp.mirantis.net/artifactory/test-images/
    load-balancer:
      octavia:
        values:
          octavia:
            settings:
              amphora_image_url: http://images.mcp.mirantis.net/octavia/amphora-x64-haproxy-stein-testing.qcow2
    networking:
      neutron:
        values:
          bootstrap:
            enabled: true
            script: "openstack network create \\\n  --provider-network-type flat \\\
              \n  --provider-physical-network external \\\n  --external \\\n  public\n\
              openstack subnet create public-subnet \\\n  --no-dhcp --subnet-range\
              \ 10.11.12.0/24 \\\n  --allocation-pool start=10.11.12.100,end=10.11.12.200\
              \ \\\n  --network public\nopenstack router create r1\nopenstack router\
              \ set --external-gateway public r1\n"
    tempest:
      tempest:
        values:
          conf:
            blacklist:
            - (?:tempest\.scenario\.test_server_basic_ops\.TestServerBasicOps\.test_server_basic_ops)
            - (?:tempest\.api\.volume\.test_volumes_actions\.VolumesActionsTest)
            - (?:tempest\.api\.volume\.test_volumes_get\.VolumesGetTest\.test_volume_create_get_update_delete_from_image)
            - (?:tempest\.api\.volume\.test_volumes_get\.VolumesGetTest\.test_volume_create_get_update_delete)
            - (?:tempest\.api\.volume\.test_volumes_list\.VolumesListTestJSON)
            - (?:tempest\.api\.compute\.servers\.test_server_actions\.ServerActionsTestJSON)
            - (?:tempest\.api\.compute\.servers\.test_create_server\.ServersTestManualDisk)
            - (?:tempest\.api\.compute\.servers\.test_attach_interfaces\.AttachInterfacesUnderV243Test\.test_add_remove_fixed_ip)
            - (?:tempest\.api\.compute\.servers\.test_server_addresses\.ServerAddressesTestJSON)
            - (?:tempest\.api\.compute\.servers\.test_create_server\.ServersTestBootFromVolume)
            - (?:tempest\.api\.compute\.servers\.test_create_server\.ServersTestJSON)
            script: 'tempest run --config-file /etc/tempest/tempest.conf -w 4 --smoke
              --blacklist-file  /etc/tempest/test-blacklist

              '
            tempest:
              compute:
                flavor_ref: 00000000-0000-0000-0000-000000000000
                flavor_ref_alt: 00000000-0000-0000-0000-000000000001
                image_ref: 00000000-0000-0000-0000-000000000000
                image_ref_alt: 00000000-0000-0000-0000-000000000001
              dashboard:
                disable_ssl_certificate_validation: true

